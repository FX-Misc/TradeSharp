<html>
<head>
    <title>Терминал TradeSharp - Новостной робот</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <style type="text/css">
        .centrAling
        {
	        text-align:center;	
        }
    </style>
    <style type="text/css">
        table.lightTable { border-width: 0 0 1px 1px; border-spacing: 0; border-collapse: collapse; border-style: solid; }
        table.lightTable tr td { margin: 0; padding: 4px; border-width: 1px 1px 0 0; border-style: solid; }
        tr.rowHeader { background-color: #BBFFAB; font-weight:bold; }
    </style>
</head>

<body>

    <img src="picts\main_logo.png" />

    <h1>Новостной робот</h1>

    <p>
        Данный робот выполняет автоматическую торговлю по новостным данным, публикуемым  на сайте компании Alpari. Данные по каждой новости, представляющие интерес для робота, следующие:
    </p>

    <ul>
        <li>дата выхода;</li>
        <li>страна;</li>
        <li>название;</li>
        <li>прогноз (прогнозируемое значение экономического показателя);</li>
        <li>фактическое (фактическое значение экономического показателя).</li>
    </ul>

    <p>
        Новостной робот обрабатывает только ограниченное множество новостей, которое предварительно задано в его файле настроек NewsRobot.dll.xml. Каждой заданной новости сопоставлена следующая информация:
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Название</td>
            <td>Комментарий</td>
        </tr>
        <tr>
            <td>Weight</td>
            <td>вес новости {-1, 1} – величина, используемая при определении необходимости входа в рынок</td>
        </tr>
        <tr>
            <td>MinDelta</td>
            <td>минимальное относительное отклонение экономического показателя (%) для выполнения обработки новости</td>
        </tr>
    </table>

    <p>
        Пример. Известно, что высокий уровень Retail Sales благоприятно влияет на рынок,
        поэтому рост показателя Retail Sales вызывает рост курса доллара. Вес этой новости равен 1.
    </p>
    <p>
        Одновременно с этим курс валютной пары (торгового инструмента), в которой доллар является основной валютой (например, USDCHF, USDJPY),
        также вырастет, а вот курс валютной пары, в которой этот же доллар является контрвалютой (например, CADUSD, EURUSD), наоборот, упадет.
        Эта зависимость учтена в знаке торгового инструмента Ti: Ti = 1 в первом случае, Ti = -1 во втором.
    </p>
    <p>
        Еще пример. Уменьшение количества заявок на пособие по безработице (Jobless claims)
        является благоприятным фактором для роста курса доллара. Вес этой новости равен -1.
    </p>

    <p>
        Для входа в рынок роботу необходима новость, удовлетворяющая определенному условию. Само условие задается в настройках,
        т.е. может быть изменено пользователем. Условие подходящей новости называется формулой для входа в рынок.
    </p>

    <a id="formula"></a>
    <h3>Формула</h3>

    <p>
        Формула для входа в рынок – это выражение, истинность которого, определяет необходимость входа в рынок.
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Название</td>
            <td>Комментарий</td>
        </tr>
        <tr>
            <td>Tn</td>
            <td>
                знак новостного сигнала<br />
                Он определяется как произведение веса новости Weight,
                знака отклонения экономического показателя Sign(Delta) и знака торгового инструмента Ti:<br />
                    Tn = Weight * Sign(Delta) * Ti.
            </td>
        </tr>
        <tr>
            <td>Tba</td>
            <td>знак тренда до выхода новости</td>
        </tr>
        <tr>
            <td>Tcb</td>
            <td>знак тренда после выхода новости</td>
        </tr>
    </table>

    <p>
        Расчет Tn для EURUSD на примере роста Retail Sales:
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Название</td>
            <td>Комментарий</td>
        </tr>
        <tr>
            <td>Weight = 1</td>
            <td>рост показателя Retail Sales вызывает рост курса USD</td>
        </tr>
        <tr>
            <td>Delta = 1</td>
            <td>показатель увеличился, т.е. фактическое значение оказалось больше прогноза</td>
        </tr>
        <tr>
            <td>Ti = -1</td>
            <td>USD – контрвалюта в EURUSD</td>
        </tr>
        <tr>
            <td>Tn = -1</td>
            <td>1 * 1 * (-1) = -1</td>
        </tr>
    </table>

    <p>
        Для ввода и проверки формулы используется редактор.
    </p>

    <div class="centrAling">
        <img src="picts\robot\news\exam_formula.png" /><br/>Рисунок – Редактор формул
    </div>

    <p>
        В редактор уже заложены заранее подготовленные формулы с комментариями по ним.
        В таблице приведены допустимые параметры для формулы с тестовыми значениями.
        По кнопке «Рассчитать» значения будут подставлены в формулу, и результат будет выведен справа от кнопки.
    </p>

    <a id="settings"></a>
    <h3>Настройки</h3>

    <p>
        Функционирование новостного робота можно изменить через окно настроек.
    </p>

    <div class="centrAling">
        <img src="picts\robot\news\exam_settings.png" /><br/>Рисунок – Настройки новостного робота
    </div>

    <p>
        Параметры робота:
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Название</td>
            <td>Комментарий</td>
        </tr>
        <tr>
            <td>Ожидание перед обработкой, мин</td>
            <td>Время ожидания перед обработкой новости, измеряемое с момента выпуска новости</td>
        </tr>
        <tr>
            <td>Дальняя отметка времени, мин</td>
            <td>Временной интервал, на котором определяется тренд до выхода новости Tba (см. рисунок «Пример работы робота»)</td>
        </tr>
        <tr>
            <td>Ближняя отметка времени, мин</td>
            <td>Временной интервал, на котором определяется тренд после выхода новости Tcb (см. рисунок «Пример работы робота»)</td>
        </tr>
        <tr>
            <td>Формула для входа в рынок</td>
            <td>(см. раздел <a href="#formula">Формула</a>)</td>
        </tr>
        <tr>
            <td>Знак входа в рынок</td>
            <td>Параметр, определяющий тип открываемого ордера (покупка/продажа)</td>
        </tr>
        <tr>
            <td>Исходный SL</td>
            <td>(см. раздел <a href="#sltp">SL/TP</a>)</td>
        </tr>
        <tr>
            <td>Исходный TP</td>
            <td>(см. раздел <a href="#sltp">SL/TP</a>)</td>
        </tr>
        <tr>
            <td>Период обновления SL/TP</td>
            <td>(см. раздел <a href="#sltp">SL/TP</a>)</td>
        </tr>
        <tr>
            <td>Изменение SL/TP</td>
            <td>(см. раздел <a href="#sltp">SL/TP</a>)</td>
        </tr>
    </table>

    <p>
        Алгоритм работы робота сводится к следующим этапам:
    </p>

    <ol>
        <li>Чтение и разбор новостных данных, получение очередной на данный момент времени новости.</li>
        <li>Определение веса и знака новости, относительного отклонения экономического показателя и, как следствие, необходимости обработки этой новости.</li>
        <li>Ожидание, чаще всего равное периоду мгновенного тренда, возникшего после выпуска новости.</li>
        <li>Определение торгового инструмента, на курс которого оказало влияние новость.</li>
        <li>Определение мгновенного и длительного тренда по каждому торговому инструменту.</li>
        <li>На основании знаков новостного сигнала и двух трендов принимаем решение о входе в рынок.</li>
        <li>Покупаем, закрыв все открытые сделки о продаже от этого торгового робота, или наоборот, продаем, закрыв все сделки о покупке.</li>
    </ol>

    <p>
        Пункты 4..7 повторяются для всех торговых инструментов из параметра «Используемые графики», в которые входит затронутая новостью валюта.
    </p>

    <a id="sltp"></a>
    <h3>SL/TP</h3>

    <p>
        Для открытой сделки устанавливаются значения «stop loss» и «take profit»,
        вычисленные как разность цены торгового инструмента на момент открытия и указанной в настройке робота величины («Исходный SL»/«Исходный TP»).
        С течением времени в открытых роботом ордерах постоянно корректируются значения SL/TP в сторону приближения к цене входа.
        Коррекция происходит с определенным периодом («Период обновления SL/TP») на фиксированную величину («Изменение SL/TP»).
        Этот процесс связан с уменьшением влияния новости на рынок со временем и в итоге приводит к закрытию ордера по причине достижения порогов SL/TP.
    </p>

    <p>
        Рассмотрим пример обновления SL/TP для одной сделки. Робот запущен со следующими <a href="#settings">настройками</a>:
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Параметр</td>
            <td>Значение</td>
        </tr>
        <tr>
            <td>Исходный TP</td>
            <td>200 п</td>
        </tr>
        <tr>
            <td>Исходный SL</td>
            <td>200 п</td>
        </tr>
        <tr>
            <td>Период обновления SL/TP</td>
            <td>60 сек</td>
        </tr>
        <tr>
            <td>Изменение SL/TP</td>
            <td>5 п</td>
        </tr>
    </table>

    <p>
        В 16:00 была открыта сделка на продажу EURUSD по 1.3290.
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Время</td>
            <td>Параметр</td>
        </tr>
        <tr>
            <td>16:00</td>
            <td>SL = 1.3200 + 200 / 10000 = 1.3400;<br />TP = 1.32 – 200 / 100000 = 1.3000</td>
        </tr>
        <tr>
            <td>16:01</td>
            <td>SL = 1.3200 + (200 - 5) / 10000 = 1.3395;<br />TP = 1.3200 - (200 - 5) / 10000 = 1.3005;</td>
        </tr>
        <tr>
            <td>...</td>
            <td>...</td>
        </tr>
        <tr>
            <td>16:25</td>
            <td>SL = 1.3200 + (200 - 125) / 10000 = 1.3275<br />TP = 1.3200 - (200 - 125) / 10000 = 1.3125;</td>
        </tr>
    </table>

    <p>
        Рассмотрим пример осуществления сделки роботом.
    </p>

    <div class="centrAling">
        <img src="picts\robot\news\exam_chart.png" /><br/>Рисунок – Пример работы робота<br />
        Tba – тренд до выхода новости: Tba = Sign(цена закрытия B - цена закрытия A) = Sign(1.33768 - 1.33735) = 1;<br />
        Tbc – тренд после выхода новости: Tcb = Sign(цена закрытия C - цена закрытия B) = Sign(1.33722 - 1.33768) = -1
    </div>

    <p>
        Робот запущен со следующими <a href="#settings">настройками</a>:
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Параметр</td>
            <td>Значение</td>
        </tr>
        <tr>
            <td>Ожидание перед обработкой, мин</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Дальняя отметка времени Tba, мин</td>
            <td>60</td>
        </tr>
        <tr>
            <td>Ближняя отметка времени Tcb Tcb, мин</td>
            <td>5</td>
        </tr>
        <tr>
            <td>Формула для входа в рынок</td>
            <td>(Tba != Tcb) & (Tсb = Tn)</td>
        </tr>
        <tr>
            <td>Знак входа в рынок</td>
            <td>Tn</td>
        </tr>
    </table>

    <p>
        Он имеет следующие настройки по новостям:
    </p>

    <table class="lightTable">
        <tr class="rowHeader">
            <td>Название</td>
            <td>Weight</td>
            <td>MinDelta</td>
        </tr>
        <tr>
            <td>Non farm pay rolls</td>
            <td>1</td>
            <td>5</td>
        </tr>
    </table>    

    <p>
        Алгоритм работы этого робота на примере одной новости:
    </p>

    <ol>
        <li>В 12:10 в US была выпущена новость: «Non farm pay rolls».</li>
        <li>Вес новости Weight = 1.<br />Отклонение показателя Delta = фактическое – прогноз = 121 – 105 = 16. Новость свидетельствует, что USD укрепляется (Delta > 0).<br />
            Знак новости: Sn = Weight * Sign(Delta) = 1 * Sign(16) = 1.<br />Относительное отклонение показателя: |(фактическое - прогноз) / прогноз| = |(121 - 105) / 105| * 100 % = 16%.
            При пороге отклонения 5% это означает, что новость будет обработана (16% > 5%).</li>
        <li>В 12:15 новость поступила на обработку.</li>
        <li>Торговый инструмент EURUSD. Знак инструмента Ti = -1. Знак новостного сигнала Tn = Weight * Sign(Delta) * Ti = 1 * 1 * (-1) = -1.</li>
        <li>Определяем знаки трендов.<br />Тренд до выхода новости Tba = Sign(1.33768 - 1.33735) = 1.<br />
            Тренд после выхода новости Tcb = Sign(1.33722 - 1.33768) = -1.</li>
        <li>Подставляем все коэффициенты в формулу для принятия решения о входе в рынок: (Tba != Tcb) & (Tсb = Tn).
            При подстановке получаем: (1 != -1) & (-1 = -1) => ИСТИНА. Выполняем вход в рынок.</li>
        <li>Определяем тип ордера To. Если To > 0, то осуществляем покупку, если To > 0, то продажу.<br />В нашем случае тип ордера определен по формуле: To = Tn,
            т.е. соответствует знаку новостного сигнала. To = -1, значит мы будем продавать.</li>
    </ol>
</body>
</html>