<html>
<head>
    <title>Терминал TradeSharp - Индикатор "Пользовательский индекс"</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
</head>

<body>
    <img src="picts\main_logo.png" />
    <h1>Индикатор "Пользовательский индекс"</h1>
    <p>
       Индикатор строит график заданной пользователем <a href="pg_formulas.htm">функции</a>. Функция задается формулами "Формула 1" - "Формула 5", каждая из которых может
       принимать аргументом значение оставльных формул. Аргументы формул могут включать:
    </p>
     
    <ul>
       <li><b>open, high, low, close</b> - цены открытия, наивысшую, наименьшую и цену закрытия свечи серии-источника. Если серия-источник представлена кривой 
          (не свечной график) - тогда все цены (OHLC) будут равны значению источника в текущей точке. Возможна запись close#7, high#50 - 
          в таком случае возьмется значение, отстоящее от текущей точки на N (7, 50) свечей/вершин назад.</li>
       <li><b>Имена торгуемых инструментов</b> вида <b>eurusd, usdjpy, gbpcad#12</b> (#12, аналогично, означает цену 12 свечей назад). Доступна только цена close.</li>
       <li><b>i</b> - индекс текущей свечи с начала отсчета</li>
       <li><b>close</b> - количество свеч/точек в серие-источнике</li>
       <li><b>year, month, day, weekday, hour, minute, second</b> - текущий год, месяц...</li>
       <li><b>random</b> - равномерно распределенное СЧ в диапазоне [0..1]</li>
       <li><b>fn1, fn2, ... fn4</b> - значение функции, заданной параметром "Формула 1" ... "Формула 4". Разрешено ссылаться в последующих формулах на предшествующие.</li>
    </ul> 

    <p>
        Параметры <b>Каталог котировок, Минут до обновления</b>. <br/>
        Если в формулах участвуют котировки других валютных пар, они берутся из каталога, прописанного в настройках. Путь относительный (от исполняемого файла).
        Если котировки в каталоге отсутствуют либо не покрывают период, для которого рассчитывается индекс, происходит автоматическая загрузка котировок из базы
        данных - в случае, если недостает фрагментав N минут от начала либо от конца истории серии источника. Здесь N - значение параметра Минут до обновления.
    </p>

    <p>
       <b>Исключения</b><br/> 
       Замена +бесконеч., Замена NaN, Замена -бесконеч. Если значение формулы посчитано как 1/0 ("+" бесконечность), -100/0 ("-" бесконечность) или 
       0/0 (Not a Number, NaN) результат будет заменен соответствующим числом.
    </p>

    <p> <b>Примеры формул</b> <br/> RSI(5)</p>
    
    <p class="excerpt">
        /*fn1=*/ (close&gt;open)*(close-open)+(close#1&gt;open#1)*(close#1-open#1)+(close#2&gt;open#2)*(close#2-open#2)+(close#3&gt;open#3)*(close#3-open#3)+(close#4&gt;open#4)*(close#4-open#4) <br/>
        /*fn2=*/ (close&lt;open)*(open-close)+(close#1&lt;open#1)*(open#1-close#1)+(close#2&lt;open#2)*(open#2-close#2)+(close#3&lt;open#3)*(open#3-close#3)+(close#4&lt;open#4)*(open#4-close#4) <br/>
        /*fn3(RSI)=*/ 100-100/(1+fn1/fn2)
    </p>
    <p>
         В строке <b>Функция 1</b> записана сумма 5-и слагаемых вида (close#N>open#N)*(close#N-open#N). Если цена close свечи N 
         (например, N=2 означает третью с конца свечу, N=5 - шестую с конца и т.д.) больше цены open той же свечи, то выражение
         (close#N>open#N) равно 1. Иначе выражение равно 0. Далее, 1 либо 0 умножаются на разницу (close-open), т.е. на "длину тела" свечи.
         Таким образом, первая функция дает нам сумму "длин тел" бычьих свеч из последних 5-и свеч.<br/>
         Аналогично, <b>вторая строка</b> дает сумму "длин тел" последних 0...5 медвежьих свеч. Результат (строка <b>Функция 3</b>) считается по классической формуле индикатора RSI,
         где U = fn1, а D = fn2.
    </p>


    <h2>Редактор формул</h2>
    <a name="editor" />
    <p>
       Во встроенном редакторе <a href="pg_formulas.htm">формул</a> индикатора реализованы шаблоны, позволяющие сгенерировать 
        одну из перечисленных ниже функций.
    </p>

    <p>
      Здесь и далее рассматривается пример валютной пары EURUSD. Для пары EURUSD логически обосновано искать дивергенции с индексами EURX, 
      приращением EURX. Индекс USDX надо брать обратный (1/USDX) – так как, когда индекс доллара растет, это в 99% случаях соответствует 
      падению курса EURUSD. Иначе говоря, валютная пара EURUSD включает индекс USDX в знаменателе отношения стоимости EUR к USD. Конечно, 
      можно искать дивергенции EURUSD и USDX, но надо понимать, что дивергенции для этих курсов – нормальное, ожидаемое поведение.
      Все индексы делятся на трендовые и осцилляторы. Осцилляторы совершают колебания вокруг среднего значения – для всех примеров ниже 
      это среднее значение можно принять за 0. К ним применимы обе разновидности дивергенций – классические и от квази-экстремумов. К трендовым 
      индикаторам применимы исключительно дивергенции от классчиеских экстремумов.
    </p>
    <h3>1 - Бивалютный индекс</h3>
    <p>       
	Период индекса (12)<br/>
	Валютная пара (EURUSD)<br/>
	Вид индекса (1) <i>сумма приращений</i><br/>
	Индикатор колеблется вокруг среднего значения (осциллятор, применимы оба вида дивергенций). Не учитывает веса валютных пар. Получен как:
    </p>
    <img src="picts\pg_usindex_formula01.PNG" />

    <p>
      т.е., разность «индекса EUR» и «индекса USD». Индекс каждой валюты считается как сумма приращений валютных пар с участием этой самой 
      валюты за период N. Если валюта (USD) входит в валютную пару (EURUSD, GBPUSD …) как контрвалюта, перед слагаемым ставится знак «-».
    </p>

    <p>
      То же,  <br/>
      <br/>Период индекса (12)
      <br/>Валютная пара (EURUSD)
      <br/>Вид индекса (2) <i>мультипликативный, торгово-взвешенный</i>
      <br/>Осциллятор. Учитывает веса валютных пар в составе индекса. Формула:
    </p>

    <img src="picts\pg_usindex_formula02.PNG" />

    <p>
      иначе говоря – приращение синтетического курса EURX/USDX. Мультипликативный торгово-взвешенный индекс EURX делится на аналогичный индекс 
      USDX (веса валютных пар актуализированы), полученная величина условно названа синтетическим курсом EURX/USDX.
    </p>

    <h3>2 - Валютный индекс</h3>

    <p>
      Валюта (eur)<br/>
      Валютная пара графика (eurusd) <i>желательно задавать, хотя и необязательно</i><br/>
      Вид индекса (1) <i>классический</i><br/>

      Валютный индекс, мультипликативный, классическая формула, учитывающая веса валютных пар. Классический индекс – веса валютных пар соответствуют 
      классическим определениям индексов, торгуемых на Нью-Йоркской бирже.<br/>
      Трендовый! Дивергенции от квази-экстремумов неприменимы.<br/>
      Вид индекса (2) <i>актуализированный</i><br/>
      то же, но веса актуализированы на конец 2010 года.
      Если планируется искать дивергенции, например, курса USDJPY и JPYX или EURUSD и USDX, индекс необходимо обратить: например, вместо            
    </p>

    <p class="excerpt">
      34.38805726*close^0.3155*eurgbp^0.3056*eurjpy^0.1891*eurchf^0.1113
    </p>

    <p>
      написать
    </p>

    <p class="excerpt">
      1/close^0.3155*eurgbp^0.3056*eurjpy^0.1891*eurchf^0.1113
    </p>

    <h3>3 Приращение индекса</h3>
    <p>
        Валюта (usd)<br/>
        Период индекса (12)<br/>
        Валютная пара графика (eurusd) <i>желательно задавать, хотя и необязательно</i><br/>
        Обратить (v) <br/>
    </p>
    <p>Формула вида</p>
    <img src="picts\pg_usindex_formula03.PNG" />
    <p>
      Берется приращение валютного индекса или обратной ему величины (если стоит флаг Обратить). Флаг ставится по тем же правилам, что и для индикатора Валютный индекс. Индекс мультипликативный, актуализированный.
      <br/>Осциллятор.
    </p>

    <h3>4 Внутритрендовое приращение</h3>
    <p>
      Параметр ()<br/>
      Период (12)<br/>
      Курс за вычетом тренда – скользящей средней с указанным периодом. В качестве параметра можно указать не только close – цену закрытия на текущем графике, но и любую другую котировку или даже выражение вида 1/usdx. 
      <br/>Осциллятор.
    </p>
</body>
</html>