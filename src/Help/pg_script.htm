<html>
<head>
    <title>Терминал TradeSharp - Сценарии</title>
    <link rel="stylesheet" type="text/css" href="styles.css" />
    <style type="text/css">
        table.lightTable { border-width: 0 0 1px 1px; border-spacing: 0; border-collapse: collapse; border-style: solid; }
        table.lightTable tr td { margin: 0; padding: 4px; border-width: 1px 1px 0 0; border-style: solid; }
        tr.rowHeader { background-color: #BBFFAB; font-weight:bold; }
    </style>
</head>

<body>
    <img src="picts\main_logo.png" />
    <h1>Сценарии (скрипты) терминала</h1>
    <p>
        Терминал Trade# позволяет автоматизировать работу с использованием <b>скриптов</b>. Примеры таких сценариев приведены ниже:
    </p>

    <ul>
        <li>Трейдер желает перенести стоп/тейк-ордера для всех открытых позиций по валютной паре EURCAD в точку, где суммарный результат этих сделок будет равен 0...</li>
        <li>Удалить с графика все комментарии, оставив прочие графичские построения...</li>
        <li>Копировать все открытые / закрытые позиции в буфер обмена Windows в формате CSV...</li>
        <li>Загрузить выбранный график на ресурс типа <a href="http://www.flickr.com/">www.flickr.com</a> в виде картинки...</li>
    </ul>

    <p>Выполнение этих сценариев трейдер, очевидно, инициирует самостоятельно. Другие же сценарии могут быть исполнены терминалом 
        <a href="#trigger">автоматически</a>, например:</p>

    <ul>
        <li>Если в 22:00 котировка EURUSD окажется в диапазоне [1.3540 - 1.3570] издать звуковой сигнал...</li>
        <li>Если сделка N закрыта по стоп-ордеру, перенести стоп-ордер всех остальных сделок по тому же инструменту в безубыток...</li>
        <li>Купить USDJPY по цене не ниже 93.75, расчитав объем входа из имеющихся на момент средств...</li>
    </ul>
    
    <p>
        Таких задач, автоматизация которых существенно сэкономила бы время и усилия трейдера, можно перечислить великое множество, и каждый трейдер
        приведет собственный список пожеланий. Часть задач уже автоматизирована в терминале Trade#. API терминала позволяет реализовать произвольные сценарии.
        Достаточно скомпилировать такой сценарий (сценарии) в файл .dll и поместить его в папку <b>plugin</b>.
    </p>

    <a name="script_type" />
    <p>
        Все сценарии разбиты на 3 группы:
    </p>
    
    <ol>
        <li>Сценарии, исполняемые для окна графика (категория <b>график</b>)</li>
        <li>Сценарии, исполняемые по торгуемому инструменту (категория <b>тикер</b>)</li>
        <li>Сценарии, не привязанные ни к графику, ни к торгуемому инструменту (категория <b>терминал</b>)</li>
    </ol>    

    <p>
        К примеру, первый из рассмотренных сценариев (<i>трейдер желает перенести стоп/тейк-ордера для всех открытых позиций 
        по валютной паре EURCAD в точку, где суммарный результат этих сделок будет равен 0</i>) связан с торгуемым инструментом.
        Четвертый сценарий (<i>разместить скриншот графика на ресурсе типа <a href="http://www.flickr.com/">www.flickr.com</a></i>)
        привязан к графику, для которого он вызывается.
        Третий сценарий (<i>копировать все ордера по счету в буфер обмена</i>) вообще не связан ни с графиком, ни с торгуемым активом.
    </p>

    <h2>Настройка сценариев</h2>
    <p>
        Вызывается из главного меню терминала, Торговля \ Скрипты.
    </p>

    <img alt="Меню 'Скрипты'" src="picts\common\script\menu_script.png" />
    <p class="pictitle">Рис. 1 Меню 'Скрипты'</p>

    <p>
        В открывшемся окне уже настроенные скрипты показаны в таблице. Добавить новый скрипт можно кликнув на ячейку
        <b>&lt;новый скрипт&gt;</b>.
    </p>

    <img alt="Таблица скриптов" src="picts\common\script\settings_window.png" />
    <p class="pictitle">Рис. 2 Таблица скриптов</p>

    <p>
        В колонке <b>Название</b> приводится название скрипта - по умолчанию совпадает со значением в колонке <b>Тип</b>. 
        Трейдер может дать скрипту любое название. Например, один скрипт типа "Сигнал" настроен на сообщение о преодолении
        USDCAD отметки 1.0300. Другой скрипт того же типа сигнализирует о закрытии сделки. Для того, чтобы различать их,
        трейдер даст двум скриптам разнче названия<br />
        Колонка <b>Категория</b> показывает, к чему применяется скрипт.<br />
        Колонка <b>Триггер</b> показывает <a href="#">условие</a>, по которому скрипт <a href="#trigger">сработает автоматически</a>.<br />
        Кликом по ячейке в последней колонке скрипт удаляется из настроек.
    </p>
    <p>
        Клик по названию скрипта открывает окно редактирования настроек сценария. Клик по ячейке в колонке <a href="#trigger">Триггер</a> приводит к
        вызову окна настройки условий автоматического исполнения скрипта.
    </p>

    <h2>Вызов сценария</h2>
    
    <p>
        Обратите внимание - вызываются только те скрипты, что были выбраны и настроены в таблице скриптов. Когда скрипты настроены, вызвать их можно:
    </p>
    
    <img alt="Таблица скриптов" src="picts\common\script\context_menu.png" />
    <p class="pictitle">Рис. 3 Вызов скрипта в окне графика</p>

    <p>
        Из окна графика в контекстном меню, вызываемом правой кнопкой мыши. Так вызываются сценарии, связанные с графиком либо с инструментом.
    </p>

    <p>
        В <b>главном меню</b> терминала - Торговля \ Скрипт - далее выбор соответствующего сценария. В списке сценариев будут лишь скрипты
        категории <b>Терминал</b> или <b>Тикер</b>. Если скрипту требуется указание инструмента, после вызова из главного меню терминала откроется
        окно выбора инструмента.
    </p>

    <p>
        При вызове сценария могут быть открыты дополнительные диалоговые окна - например, при переносе ордеров по сделкам в точку безубытка
        скрипт может "уточнить" желаемую суммарную прибыль / убыток по модифицируемым позициям для расчета целевой цены.
    </p>

    <a name="trigger" />
    <h3>Автоматическое исполнение сценариев - триггеры</h3>

    <p>
        Сценарий вызовется автоматически, если в настройках задан соответствующий триггер. Для автоматического запуска определены 3 события:
    </p>

    <ol>
        <li>Обновление котировки указанных инструментов</li>
        <li>Обновление ордеров</li>
        <li>Условие, заданное <a href="pg_formulas.htm">формулой</a></li>
    </ol>

    <img alt="Триггер" src="picts\common\script\trigger_window.png" />
    <p class="pictitle">Рис. 4 Окно настройки триггера скрипта</p>

    <p>
        Вкладка <b>Котировки</b> - указываются инструменты, обновление котировок которых приведет к выполнению сценария.
        Если ни одна котировка не указана, сценарий будет вызван при обновлении любой котировки. <br />
        <b>Важно отметить:</b> даже если сценарий запущен автоматически, он необязательно выполнит какие-либо действия,
        так как, возможно, логика самого сценария требует дополнительных условий.
    </p>

    <p>
        Вкладка <b>Ордера</b> - указывается одно <b>или несколько</b> событий, которые приведут к запуску сценария (открытие, закрытие,
        модификация ордера). К примеру, если выбрано событие - закрытие ордера - скрипт будет запущен вне зависимости от того,
        был ли ордер закрыт трейдером либо закрыт автоматически, по ценовой отметке StopLoss, либо по иной причине.
        В логике скрипта могут быть учтены параметры ордера, который был закрыт, открыт либо модифицирован.
    </p>

    <h3>Вкладка Формула</h3>

    <p>
        Скрипт будет выполнен, если <a href="pg_formulas.htm">формула</a>, заданная пользователем, примет отличное от 0 значение.
        Примеры формул:
    </p>

    <p class="excerpt">
        GBPUSD > 1.5520
    </p>
    
    <p>
        Как нетрудно догадаться, скрипт будет выполнен, когда цена GBPUSD превысит отметку 1.5520. Скрипт будет выполняться раз за разом, 
        пока выполняется условие. В сценарии, очевидно, должна быть предусмотрена логика, ограничивающая частоту / и / или количество
        срабатываний.
    </p>

    <p>
        В формуле можно указывать не только торгуемые инструменты, но и переменные, перечисленный в списке под строкой ввода формулы.
        Например:
    </p>

    <p class="excerpt">
        (GBPUSD > 1.5520) & (hour = 22) & (minute = 0)
    </p>

    <p>
        Сценарий будет выполнен при цене, превышающей отметку 1.5520 строго в 22:00. Однако, если в логике сценария нет дополнительных условий,
        ограничивающих частоту срабатывания, скрипт может выполниться столько раз, сколько раз будет обновлена котировка GBPUSD на интервале
        22:00:00 - 22:00:59.
    </p>

    <h2>Быстрый вызов скриптов</h2>
    <p>
        Скрипт можно вызвать кнопкой <img src="picts\common\script\gear_16.png" /> <a href="pg_tools.htm">на панеле инструментов</a>.
        Выбрав соответствующий режим (скрипт), нажмите левую кнопку мыши в определенной точке графика (или - в любой точке
        графика, если координаты привязки не важны).
    </p>

    <p>
        Также скрипт можно вызвать из инструментальной панели в левой части окна терминала (меню <b>Вид | Инструменты</b>):
    </p>

    <img src="picts\common\script\tool_panel.png" />
    <p class="pictitle">Рис. 5 Вызов скрипта из инструментальной панели</p>
    
    <p>
        На рисунке две верхних строчки таблицы скриптов соответствуют скриптам,
        <a href="#script_type">активируемым с указанием графика</a>. Следующая строчка (Сигнал) - скрипту, активируемому
        без указания графика / торгуемого актива. Последние три строчки (значок <span style="color:green; font-weight: bolder">$</span>) -
        скрипт, активируемый с указанием таймфрейма.
    </p>

    <p>
        Скрипт "перетаскивается" из инструментальной панели на график. Скрипт, не привязанный ни к графику, ни к инструменту, вызывается сразу по щелчку
        левой кнопкой мыши.
    </p>
        
</body>
</html>